# Task0
Давайте сделаем простую агрегацию, пожалуйста, напишите SQL-выражение, которое возвращает идентификаторы людей и соответствующее количество посещений в любых пиццериях и сортирует по количеству посещений в убывающем режиме и сортирует по person_idвозрастанию. Пожалуйста, взгляните на образец данных ниже.

| person_id | count_of_visits |
| ------ | ------ |
| 9 | 4 |
| 4 | 3 |
| ... | ... | 

# Task1
Измените SQL-выражение из упражнения 00 и верните имя человека (не идентификатор). Дополнительным условием является то, что нам нужно увидеть только 4 лучших человека с максимальным количеством посещений в каждой пиццерии и отсортировать по имени человека. Смотрите пример выходных данных ниже.

| name | count_of_visits |
| ------ | ------ |
| Dmitriy | 4 |
| Denis | 3 |
| ... | ... | 

# Task2
Напишите SQL-выражение, чтобы увидеть 3 любимых ресторана по посещениям и по заказам в списке (добавьте столбец action_type со значениями «order» или «visit», это зависит от данных из соответствующей таблицы). Посмотрите на пример данных ниже. Результат должен быть отсортирован в порядке возрастания по столбцу action_type и в порядке убывания по столбцу count.

| name | count | action_type |
| ------ | ------ | ------ |
| Dominos | 6 | order |
| ... | ... | ... |
| Dominos | 7 | visit |
| ... | ... | ... |

# Task3
Напишите SQL-выражение, чтобы увидеть, как рестораны группируются по посещениям и по заказам, а также объединяются по названию ресторана. 
Вы можете использовать внутренний SQL из упражнения 02 (Рестораны по посещениям и по заказам) без каких-либо ограничений на количество строк.
Кроме того, добавьте следующие правила.

Вычислите сумму заказов и посещений для соответствующей пиццерии (обратите внимание, что не все ключи пиццерий представлены в обеих таблицах).
Сортируйте результаты по total_countстолбцу в порядке убывания и по nameстолбцу в порядке возрастания. Взгляните на пример данных ниже.

| name | total_count |
| ------ | ------ |
| Dominos | 13 |
| DinoPizza | 9 |
| ... | ... | 

# Task4
Пожалуйста, напишите SQL-выражение, которое возвращает имя человека и соответствующее количество посещений любой пиццерии, если человек посетил ее более 3 раз (> 3). Пожалуйста, взгляните на пример данных ниже.

| name | count_of_visits |
| ------ | ------ |
| Dmitriy | 4 |

# Task5
Напишите простой SQL-запрос, который возвращает список уникальных имен людей, которые делали заказы в любой пиццерии. Результат должен быть отсортирован по имени человека.

# Task6
Напишите SQL-выражение, которое возвращает количество заказов, среднюю цену, максимальную цену и минимальную цену пиццы, проданной каждой пиццерией. Результат должен быть отсортирован по названию пиццерии.

# Task7
Напишите SQL-выражение, которое возвращает общий средний рейтинг (имя выходного атрибута — global_rating) для всех ресторанов. Округлите средний рейтинг до 4 чисел с плавающей точкой.

# Task8
Мы знаем личные адреса из наших данных. Предположим, что этот человек посещает только пиццерии в своем городе. Напишите SQL-выражение, которое возвращает адрес, название пиццерии и сумму заказов этого человека. Результат должен быть отсортирован по адресу, а затем по названию ресторана. 

# Task9
Напишите SQL-выражение, которое возвращает агрегированную информацию по адресу человека, результат «Максимальный возраст - (Минимальный возраст / Максимальный возраст)», представленный в виде столбца формулы, затем следует средний возраст по адресу и результат сравнения между столбцами формулы и средним значением (другими словами, если формула больше среднего, то значение True, в противном случае значение False).